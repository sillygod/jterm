#!/bin/bash
# Web Terminal Markdown Viewer
# Usage: mdcat <markdown_file>

if [ -z "$1" ]; then
    echo "Usage: mdcat <markdown_file>"
    exit 1
fi

FILE_PATH="$1"

if [ ! -f "$FILE_PATH" ]; then
    echo "Error: File not found: $FILE_PATH"
    exit 1
fi

ABS_PATH=$(realpath "$FILE_PATH" 2>/dev/null || readlink -f "$FILE_PATH" 2>/dev/null || echo "$FILE_PATH")
EXT="${FILE_PATH##*.}"
EXT_LOWER=$(echo "$EXT" | tr '[:upper:]' '[:lower:]')

case "$EXT_LOWER" in
    md|markdown)
        printf '\033]1337;ViewMarkdown=%s\007' "$ABS_PATH"
        ;;
    *)
        echo "Error: Not a markdown file: $EXT_LOWER"
        echo "Supported: md, markdown"
        exit 1
        ;;
esac
